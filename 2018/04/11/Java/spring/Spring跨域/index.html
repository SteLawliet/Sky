<!DOCTYPE html>
<html>
<head>
    

    

    



    <meta charset="utf-8">
    
    
    
    
    <title>stelawliet | 迁移整理中...</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="">
    <meta name="description" content="CORS support in Spring FrameworkENGINEERING  SÉBASTIEN DELEUZE JUNE 08, 2015 56 COMMENTS For security reasons, browsers prohibit AJAX calls to resources residing outside the current origin. For exampl">
<meta name="keywords" content="blog">
<meta property="og:type" content="article">
<meta property="og:title" content="stelawliet">
<meta property="og:url" content="http://io.stelawliet.top/2018/04/11/Java/spring/Spring跨域/index.html">
<meta property="og:site_name" content="stelawliet">
<meta property="og:description" content="CORS support in Spring FrameworkENGINEERING  SÉBASTIEN DELEUZE JUNE 08, 2015 56 COMMENTS For security reasons, browsers prohibit AJAX calls to resources residing outside the current origin. For exampl">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://gravatar.com/avatar/5e2908bea32b1f0519a48d5c2f66f000?s=20&d=mm">
<meta property="og:updated_time" content="2018-04-11T11:00:23.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="stelawliet">
<meta name="twitter:description" content="CORS support in Spring FrameworkENGINEERING  SÉBASTIEN DELEUZE JUNE 08, 2015 56 COMMENTS For security reasons, browsers prohibit AJAX calls to resources residing outside the current origin. For exampl">
<meta name="twitter:image" content="https://gravatar.com/avatar/5e2908bea32b1f0519a48d5c2f66f000?s=20&d=mm">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="/css/style.css?v=1.7.2">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu"  >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">Stelawliet</h5>
          <a href="mailto:Stelawliet@gmail.com" title="Stelawliet@gmail.com" class="mail">Stelawliet@gmail.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/Stelawliet" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://twitter.com/Stelawliet" target="_blank" >
                <i class="icon icon-lg icon-twitter"></i>
                twitter
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://twitter.com/Stelawliet"  >
                <i class="icon icon-lg icon-link"></i>
                测试
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis"></div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="検索">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title"></h1>
        <h5 class="subtitle">
            
                <time datetime="2018-04-11T10:59:21.000Z" itemprop="datePublished" class="page-time">
  2018-04-11
</time>


            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#CORS-support-in-Spring-Framework"><span class="post-toc-number">1.</span> <span class="post-toc-text">CORS support in Spring Framework</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Controller-method-CORS-configuration"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">Controller method CORS configuration</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Global-CORS-configuration"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">Global CORS configuration</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#JavaConfig"><span class="post-toc-number">1.2.1.</span> <span class="post-toc-text">JavaConfig</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#XML-namespace"><span class="post-toc-number">1.2.2.</span> <span class="post-toc-text">XML namespace</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#How-does-it-work"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">How does it work?</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Filter-based-CORS-support"><span class="post-toc-number">1.4.</span> <span class="post-toc-text">Filter based CORS support</span></a></li></ol></li></ol>
        </nav>
    </aside>


<article id="post-Java/spring/Spring跨域"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title"></h1>
        <div class="post-meta">
            <time class="post-time" title="2018-04-11 18:59:21" datetime="2018-04-11T10:59:21.000Z"  itemprop="datePublished">2018-04-11</time>

            


            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h1 id="CORS-support-in-Spring-Framework"><a href="#CORS-support-in-Spring-Framework" class="headerlink" title="CORS support in Spring Framework"></a>CORS support in Spring Framework</h1><p>ENGINEERING</p>
<p><img src="https://gravatar.com/avatar/5e2908bea32b1f0519a48d5c2f66f000?s=20&amp;d=mm" alt="img"> <a href="https://spring.io/team/sdeleuze" target="_blank" rel="noopener">SÉBASTIEN DELEUZE</a></p>
<p>JUNE 08, 2015</p>
<p>56 COMMENTS</p>
<p>For security reasons, browsers prohibit AJAX calls to resources residing outside the current origin. For example, as you’re checking your bank account in one tab, you could have the evil.com website in another tab. The scripts from evil.com shouldn’t be able to make AJAX requests to your bank API (withdrawing money from your account!) using your credentials.</p>
<p><a href="https://spring.io/understanding/CORS" target="_blank" rel="noopener">Cross-origin resource sharing</a> (CORS) is a <a href="https://www.w3.org/TR/cors/" target="_blank" rel="noopener">W3C specification</a> implemented by <a href="https://caniuse.com/#feat=cors" target="_blank" rel="noopener">most browsers</a>that allows you to specify in a flexible way what kind of cross domain requests are authorized, instead of using some less secured and less powerful hacks like IFrame or JSONP.</p>
<p><a href="https://spring.io/blog/2015/07/31/spring-framework-4-2-goes-ga" target="_blank" rel="noopener">Spring Framework 4.2 GA</a> provides <a href="https://jira.spring.io/browse/SPR-9278" target="_blank" rel="noopener">first class support for CORS</a> out-of-the-box, giving you an easier and more powerful way to configure it than typical <a href="http://software.dzhuvinov.com/cors-filter.html" target="_blank" rel="noopener">filter based</a> solutions.</p>
<p>Spring MVC provides high-level configuration facilities, described bellow.</p>
<h2 id="Controller-method-CORS-configuration"><a href="#Controller-method-CORS-configuration" class="headerlink" title="Controller method CORS configuration"></a>Controller method CORS configuration</h2><p>You can add to your <code>@RequestMapping</code> annotated handler method a <a href="https://docs.spring.io/spring-framework/docs/4.2.x/javadoc-api/org/springframework/web/bind/annotation/CrossOrigin.html" target="_blank" rel="noopener"><code>@CrossOrigin</code></a>annotation in order to enable CORS on it (by default <code>@CrossOrigin</code> allows all origins and the HTTP methods specified in the <code>@RequestMapping</code> annotation):</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">@RestController</span><br><span class="line">@RequestMapping(&quot;/account&quot;)</span><br><span class="line">public class AccountController &#123;</span><br><span class="line"></span><br><span class="line">	@CrossOrigin</span><br><span class="line">	@GetMapping(&quot;/&#123;id&#125;&quot;)</span><br><span class="line">	public Account retrieve(@PathVariable Long id) &#123;</span><br><span class="line">		// ...</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@DeleteMapping(&quot;/&#123;id&#125;&quot;)</span><br><span class="line">	public void remove(@PathVariable Long id) &#123;</span><br><span class="line">		// ...</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>It is also possible to enable CORS for the whole controller:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">@CrossOrigin(origins = &quot;http://domain2.com&quot;, maxAge = 3600)</span><br><span class="line">@RestController</span><br><span class="line">@RequestMapping(&quot;/account&quot;)</span><br><span class="line">public class AccountController &#123;</span><br><span class="line"></span><br><span class="line">	@GetMapping(&quot;/&#123;id&#125;&quot;)</span><br><span class="line">	public Account retrieve(@PathVariable Long id) &#123;</span><br><span class="line">		// ...</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@DeleteMapping(&quot;/&#123;id&#125;&quot;)</span><br><span class="line">	public void remove(@PathVariable Long id) &#123;</span><br><span class="line">		// ...</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>In this example CORS support is enabled for both <code>retrieve()</code> and <code>remove()</code> handler methods, and you can also see how you can customize the CORS configuration using <code>@CrossOrigin</code> attributes.</p>
<p>You can even use both controller and method level CORS configurations, Spring will then combine both annotation attributes to create a merged CORS configuration.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">@CrossOrigin(maxAge = 3600)</span><br><span class="line">@RestController</span><br><span class="line">@RequestMapping(&quot;/account&quot;)</span><br><span class="line">public class AccountController &#123;</span><br><span class="line"></span><br><span class="line">	@CrossOrigin(origins = &quot;http://domain2.com&quot;)</span><br><span class="line">	@GetMapping(&quot;/&#123;id&#125;&quot;)</span><br><span class="line">	public Account retrieve(@PathVariable Long id) &#123;</span><br><span class="line">		// ...</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@DeleteMapping(&quot;/&#123;id&#125;&quot;)</span><br><span class="line">	public void remove(@PathVariable Long id) &#123;</span><br><span class="line">		// ...</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>If you are using Spring Security, make sure to <a href="https://docs.spring.io/spring-security/site/docs/current/reference/html/cors.html" target="_blank" rel="noopener">enable CORS at Spring Security level</a> as well to allow it to leverage the configuration defined at Spring MVC level.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@EnableWebSecurity</span><br><span class="line">public class WebSecurityConfig extends WebSecurityConfigurerAdapter &#123;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	protected void configure(HttpSecurity http) throws Exception &#123;</span><br><span class="line">		http.cors().and()...</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Global-CORS-configuration"><a href="#Global-CORS-configuration" class="headerlink" title="Global CORS configuration"></a>Global CORS configuration</h2><p>In addition to fine-grained, annotation-based configuration you’ll probably want to define some global CORS configuration as well. This is similar to using filters but can be declared withing Spring MVC and combined with fine-grained <code>@CrossOrigin</code> configuration. By default all origins and <code>GET</code>, <code>HEAD</code> and <code>POST</code> methods are allowed.</p>
<h3 id="JavaConfig"><a href="#JavaConfig" class="headerlink" title="JavaConfig"></a>JavaConfig</h3><p>Enabling CORS for the whole application is as simple as:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@Configuration</span><br><span class="line">@EnableWebMvc</span><br><span class="line">public class WebConfig extends WebMvcConfigurerAdapter &#123;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public void addCorsMappings(CorsRegistry registry) &#123;</span><br><span class="line">		registry.addMapping(&quot;/**&quot;);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>If you are using Spring Boot, it is recommended to just declare a <code>WebMvcConfigurer</code> bean as following:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">@Configuration</span><br><span class="line">public class MyConfiguration &#123;</span><br><span class="line"></span><br><span class="line">    @Bean</span><br><span class="line">    public WebMvcConfigurer corsConfigurer() &#123;</span><br><span class="line">        return new WebMvcConfigurerAdapter() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void addCorsMappings(CorsRegistry registry) &#123;</span><br><span class="line">                registry.addMapping(&quot;/**&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>You can easily change any properties, as well as only apply this CORS configuration to a specific path pattern:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">public void addCorsMappings(CorsRegistry registry) &#123;</span><br><span class="line">	registry.addMapping(&quot;/api/**&quot;)</span><br><span class="line">		.allowedOrigins(&quot;http://domain2.com&quot;)</span><br><span class="line">		.allowedMethods(&quot;PUT&quot;, &quot;DELETE&quot;)</span><br><span class="line">			.allowedHeaders(&quot;header1&quot;, &quot;header2&quot;, &quot;header3&quot;)</span><br><span class="line">		.exposedHeaders(&quot;header1&quot;, &quot;header2&quot;)</span><br><span class="line">		.allowCredentials(false).maxAge(3600);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>If you are using Spring Security, make sure to <a href="https://docs.spring.io/spring-security/site/docs/current/reference/html/cors.html" target="_blank" rel="noopener">enable CORS at Spring Security level</a> as well to allow it to leverage the configuration defined at Spring MVC level.</p>
<h3 id="XML-namespace"><a href="#XML-namespace" class="headerlink" title="XML namespace"></a>XML namespace</h3><p>It is also possible to configure CORS with the <a href="https://jira.spring.io/browse/SPR-13046" target="_blank" rel="noopener">mvc XML namespace</a>.</p>
<p>This minimal XML configuration enable CORS on <code>/**</code> path pattern with the same default properties than the JavaConfig one:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;mvc:cors&gt;</span><br><span class="line">	&lt;mvc:mapping path=&quot;/**&quot; /&gt;</span><br><span class="line">&lt;/mvc:cors&gt;</span><br></pre></td></tr></table></figure>
<p>It is also possible to declare several CORS mappings with customized properties:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;mvc:cors&gt;</span><br><span class="line"></span><br><span class="line">	&lt;mvc:mapping path=&quot;/api/**&quot;</span><br><span class="line">		allowed-origins=&quot;http://domain1.com, http://domain2.com&quot;</span><br><span class="line">		allowed-methods=&quot;GET, PUT&quot;</span><br><span class="line">		allowed-headers=&quot;header1, header2, header3&quot;</span><br><span class="line">		exposed-headers=&quot;header1, header2&quot; allow-credentials=&quot;false&quot;</span><br><span class="line">		max-age=&quot;123&quot; /&gt;</span><br><span class="line"></span><br><span class="line">	&lt;mvc:mapping path=&quot;/resources/**&quot;</span><br><span class="line">		allowed-origins=&quot;http://domain1.com&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/mvc:cors&gt;</span><br></pre></td></tr></table></figure>
<p>If you are using Spring Security, don’t forget to <a href="https://docs.spring.io/spring-security/site/docs/current/reference/html/cors.html" target="_blank" rel="noopener">enable CORS at Spring Security level</a> as well:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;http&gt;</span><br><span class="line">	&lt;!-- Default to Spring MVC&apos;s CORS configuration --&gt;</span><br><span class="line">	&lt;cors /&gt;</span><br><span class="line">	...</span><br><span class="line">&lt;/http&gt;</span><br></pre></td></tr></table></figure>
<h2 id="How-does-it-work"><a href="#How-does-it-work" class="headerlink" title="How does it work?"></a>How does it work?</h2><p>CORS requests (<a href="https://github.com/spring-projects/spring-framework/blob/master/spring-webmvc/src/main/java/org/springframework/web/servlet/FrameworkServlet.java#L906" target="_blank" rel="noopener">including preflight ones with an <code>OPTIONS</code> method</a>) are automatically dispatched to the various <code>HandlerMapping</code>s registered. They handle CORS preflight requests and intercept CORS simple and actual requests thanks to a <a href="https://docs.spring.io/spring/docs/4.2.x/javadoc-api/org/springframework/web/cors/CorsProcessor.html" target="_blank" rel="noopener">CorsProcessor</a> implementation (<a href="https://github.com/spring-projects/spring-framework/blob/master/spring-web/src/main/java/org/springframework/web/cors/DefaultCorsProcessor.java" target="_blank" rel="noopener">DefaultCorsProcessor</a> by default) in order to add the relevant CORS response headers (like <code>Access-Control-Allow-Origin</code>). <a href="https://docs.spring.io/spring/docs/4.2.x/javadoc-api/org/springframework/web/cors/CorsConfiguration.html" target="_blank" rel="noopener">CorsConfiguration</a> allows you to specify how the CORS requests should be processed: allowed origins, headers, methods, etc. It can be provided in various ways:</p>
<ul>
<li><a href="https://docs.spring.io/spring/docs/4.2.x/javadoc-api/org/springframework/web/servlet/handler/AbstractHandlerMapping.html#setCorsConfiguration-java.util.Map-" target="_blank" rel="noopener"><code>AbstractHandlerMapping#setCorsConfiguration()</code></a> allows to specify a <code>Map</code> with several <a href="https://docs.spring.io/spring/docs/4.2.x/javadoc-api/org/springframework/web/cors/CorsConfiguration.html" target="_blank" rel="noopener">CorsConfiguration</a> mapped on path patterns like <code>/api/**</code></li>
<li>Subclasses can provide their own <code>CorsConfiguration</code> by overriding <code>AbstractHandlerMapping#getCorsConfiguration(Object, HttpServletRequest)</code>method</li>
<li>Handlers can implement <a href="https://docs.spring.io/spring/docs/4.2.x/javadoc-api/org/springframework/web/cors/CorsConfigurationSource.html" target="_blank" rel="noopener"><code>CorsConfigurationSource</code></a> interface (like <a href="https://github.com/spring-projects/spring-framework/blob/master/spring-webmvc/src/main/java/org/springframework/web/servlet/resource/ResourceHttpRequestHandler.java" target="_blank" rel="noopener"><code>ResourceHttpRequestHandler</code></a> now does) in order to provide a <a href="https://docs.spring.io/spring/docs/4.2.x/javadoc-api/org/springframework/web/cors/CorsConfiguration.html" target="_blank" rel="noopener">CorsConfiguration</a> for each request.</li>
</ul>
<h2 id="Filter-based-CORS-support"><a href="#Filter-based-CORS-support" class="headerlink" title="Filter based CORS support"></a>Filter based CORS support</h2><p>As an alternative to other methods presented above, Spring Framework also provides a <a href="https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/web/filter/CorsFilter.html" target="_blank" rel="noopener">CorsFilter</a>. In that case, instead of using <code>@CrossOrigin</code> or <code>WebMvcConfigurer#addCorsMappings(CorsRegistry)</code>, you can for example declare the filter as following in your Spring Boot application:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">@Configuration</span><br><span class="line">public class MyConfiguration &#123;</span><br><span class="line"></span><br><span class="line">	@Bean</span><br><span class="line">	public FilterRegistrationBean corsFilter() &#123;</span><br><span class="line">		UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();</span><br><span class="line">		CorsConfiguration config = new CorsConfiguration();</span><br><span class="line">		config.setAllowCredentials(true);</span><br><span class="line">		config.addAllowedOrigin(&quot;http://domain1.com&quot;);</span><br><span class="line">		config.addAllowedHeader(&quot;*&quot;);</span><br><span class="line">		config.addAllowedMethod(&quot;*&quot;);</span><br><span class="line">		source.registerCorsConfiguration(&quot;/**&quot;, config);</span><br><span class="line">		FilterRegistrationBean bean = new FilterRegistrationBean(new CorsFilter(source));</span><br><span class="line">		bean.setOrder(0);</span><br><span class="line">		return bean;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    最終更新：<time datetime="2018-04-11T11:00:23.000Z" itemprop="dateUpdated">2018-04-11 19:00:23</time>
</span><br>


        
        <a href="/2018/04/11/Java/spring/Spring跨域/" target="_blank" rel="external">http://io.stelawliet.top/2018/04/11/Java/spring/Spring跨域/</a>
        
    </div>
    
    <footer>
        <a href="http://io.stelawliet.top">
            <img src="/img/avatar.jpg" alt="Stelawliet">
            Stelawliet
        </a>
    </footer>
</blockquote>

        


        <div class="post-footer">
            

            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://io.stelawliet.top/2018/04/11/Java/spring/Spring跨域/&title=stelawliet&pic=http://io.stelawliet.top/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://io.stelawliet.top/2018/04/11/Java/spring/Spring跨域/&title=stelawliet&source=sky" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://io.stelawliet.top/2018/04/11/Java/spring/Spring跨域/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=stelawliet&url=http://io.stelawliet.top/2018/04/11/Java/spring/Spring跨域/&via=http://io.stelawliet.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://io.stelawliet.top/2018/04/11/Java/spring/Spring跨域/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2018/04/11/JavaScript/bootstrap3/全局样式/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">[no title]</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2018/04/10/JavaScript/Vue.js/生命周期/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">[no title]</h4>
      </a>
    </div>
  
</nav>



    











    <!-- Valine Comments -->
    <div class="comments vcomment" id="comments"></div>
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src="//unpkg.com/valine@latest/dist/Valine.min.js"></script>
    <!-- Valine Comments script -->
    <script>
        var GUEST_INFO = ['nick','mail','link'];
        var guest_info = 'nick,mail,link'.split(',').filter(function(item){
          return GUEST_INFO.indexOf(item) > -1
        });
        new Valine({
            el: '#comments',
            notify: 'false' == 'true',
            verify: 'false' == 'true',
            appId: "yg0YOBlsgCru0mqR8zfr7Xsm-gzGzoHsz",
            appKey: "QDgspYKufF8K1YCR46v7udft",
            avatar: "mm",
            placeholder: "Just go go",
            guest_info: guest_info.length == 0 ? GUEST_INFO : guest_info,
            pageSize: "10"
        })
    </script>
    <!-- Valine Comments end -->







</article>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
            <span>このブログの内容物は<a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.ja">クリエイティブ・コモンズ 表示 - 非営利 - 継承 4.0 国際ライセンスの下に提供されています</a></span>
        </p>
    </div>
    <div class="bottom">
        <p><span>Stelawliet &copy; 2015 - 2018</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://io.stelawliet.top/2018/04/11/Java/spring/Spring跨域/&title=stelawliet&pic=http://io.stelawliet.top/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://io.stelawliet.top/2018/04/11/Java/spring/Spring跨域/&title=stelawliet&source=sky" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://io.stelawliet.top/2018/04/11/Java/spring/Spring跨域/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=stelawliet&url=http://io.stelawliet.top/2018/04/11/Java/spring/Spring跨域/&via=http://io.stelawliet.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://io.stelawliet.top/2018/04/11/Java/spring/Spring跨域/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACKUlEQVR42u3aQU7FMAwEUO5/6c8WCbWacQpSk9cVKqXkdTFyHH99xdcnuK6e/Hn/6p1Xdx6+MDAwXsuYLe7qyd9vTniz/4uBgXEaI1lEHp1tgOYxfXkfAwMD47aAyyP7/g3JJ8PAwMCYBW5SaN4/mfAwMDAwVuJyVva14f7YXhwDA+OFjHwp///zn5xvYGBgvIrxKa9ZSdcWf/WqMDAwtmbkATdr8SfHmbPAxcDAOIfRtsOitlewcV2J8vobY2BgbMRoW/lt8ytv5+WhHFW4GBgYL2fcR2cSiyvb1xmv6AtiYGBsxMg3kwlpJXBzNgYGxjmMWfy199ucrD8TBgbG1oy2WJy1zGYttrwhiIGBcQKjjbykXJsNWMyCGAMDY2/GLObyf7zS6C8OVjEwMLZmJA/l4ThbVjtSFr0NAwNjU8ZskGvWPrt/Mj8cvTwkwMDA2JqRLzoJxzrv4xIQAwPjHEY9lxEHa/tXSVPv8jNhYGBszWjbZO256GxZwzEODAyMYxizFttseGIW2dGwBQYGxqaM9tXtQNjKcqOPi4GBcQyjbZO1G+Ci1GvHLDAwMDZlfMqrXdbK0UJBxcDA2JrRlmX58EQ7eJG0/x4oMTEwMF7LaEey2uOEPILbT4aBgXEaoxhrCH7bFnOzcTEMDAyMWXX57IhYAcbAwMCIhydWxinaQ9AHAhcDA+NVjHwRedNt9nxbIGJgYJzAaDeZ7UKjLehoo4uBgXEA4xuNyWqYEzMoiAAAAABJRU5ErkJggg==" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: false };


</script>

<script src="/js/main.min.js?v=1.7.2"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="/js/search.min.js?v=1.7.2" async></script>






<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = 'sky';
            clearTimeout(titleTime);
        } else {
            document.title = '(つェ⊂)咦!又好了!';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
